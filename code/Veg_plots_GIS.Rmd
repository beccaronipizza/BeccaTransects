---
title: "Veg_plots_GIS"
author: "Becca Morris"
date: "2024-04-02"
output: html_document
---
```{r}
library(readxl)
library(tidyverse)
library(dplyr)
library(viridisLite)
library(lubridate)
library(naniar) #allows you to use the replace_with_na_at()
library(gridExtra)
library(ggtext)
library(ggpubr)
library(mdthemes)
```

```{r}
setwd("~/GitHub/BeccaTransects/data")

GISvegdata <- read.csv("~/GitHub/BeccaTransects/data/GIS_ThreeYear_VegChange.csv")
```

#set up the color-blind color palette
```{r}
cbp <- c("#D55E00","#009E73", "#0072B2", "#F0E442", "#CC79A7", "#56B4E9","#E69F00", "#000000")
```






#Creating a data frame with all three zones combined and broken up by shoreline end:
```{r}
GISveg_byshoreline <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month, -Year) %>% 
  filter(Zone == "All" & Shoreline_end != "both") %>% 
  group_by(Shoreline_end)
  
```

#For Hectares:
```{r}
GISvegplot <- ggplot(GISveg_byshoreline, 
                     mapping = aes(x = Date,
                                   y = Hectares,
                                   group = Shoreline_end,
                                   color = Shoreline_end)) +
  geom_point(size = 3) +
  guides(color = guide_legend(title = "Shoreline End")) +
  geom_line() +
  scale_fill_manual(values = cbp) +
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery (Hectares)",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GISvegplot
```






# Creating a data frame for all three zones, but with both shoreline ends combined:
```{r}
GISveg_byZ <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month, -Year) %>% 
  filter(Zone != "All" & Shoreline_end == "both") %>%
  mutate(Zone = factor(Zone, levels = c("Upper", "Middle", "Lower"))) %>% #make it so that they get plotted int he correct order
  group_by(Zone)
  
```

#For Hectares:
```{r}
GISvegplot_byZ <- ggplot(GISveg_byZ, 
                     mapping = aes(x = Date,
                                   y = Hectares,
                                   group = Zone,
                                   color = Zone,
                                   shape =  Zone)) +
  geom_point(size = 3, position = position_dodge(0.2)) +
  geom_line(linewidth = 0.8, position = position_dodge(0.2)) +
  scale_color_manual(
    name = "Marsh Zone",
    values = c("#D55E00","#009E73", "#0072B2"),
    labels = c("Upper", "Middle", "Lower")) +
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery (Hectares)",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Hectares",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_byZ") +
    #caption = "*Error bars reflect standard error",
  theme_bw(base_size = 10) +
  guides(shape = FALSE) + #turns off legend for shape
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GISvegplot_byZ
```





# Creating a data frame with all years broken up by zone and shoreline end:
#Creating a data frame with all three zones combined and broken up by shoreline end:
```{r}
GISveg_byZandS <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month) %>% 
  filter(Zone != "All", Shoreline_end != "both") %>% 
  mutate(Shoreline_end = factor(Shoreline_end, levels = c("west", "east")),
         Zone = factor(Zone, levels = c("Upper", "Middle", "Lower"))) %>% #make it sot hat facet grid orders shoreline end from west to east
  group_by(Date, Zone, Shoreline_end) 
```

# Barplot faceted with Shoreline end and year, broken up by zone:
```{r}
GISvegplot_byZandS <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = Hectares,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 0.9)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery (Hectares)",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_byZandS") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = Hectares), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  

GISvegplot_byZandS
```


