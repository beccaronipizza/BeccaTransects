"---
title: "Veg_plots_GIS"
author: "Becca Morris"
date: "2024-04-02"
output: html_document
---
```{r}
library(readxl)
library(tidyverse)
library(dplyr)
library(viridisLite)
library(lubridate)
library(naniar) #allows you to use the replace_with_na_at()
library(gridExtra)
library(ggtext)
library(ggpubr)
library(mdthemes)
```

```{r}
setwd("~/GitHub/BeccaTransects/data")

GISvegdata <- read.csv("~/GitHub/BeccaTransects/data/GIS_ThreeYear_VegChange.csv")
GISvegdata_percent <- read.csv("~/GitHub/BeccaTransects/data/GIS_Veg_PercentChange.csv")
GISvegdata_percent_v2 <- read.csv("~/GitHub/BeccaTransects/data/GIS_VegPercentChange_v2.csv")
```

#set up the color-blind color palette
```{r}
cbp <- c("#D55E00","#009E73", "#56B4E9", "#0072B2", "#F0E442", "#CC79A7","#E69F00", "#000000")
```






#Creating a data frame with all three zones combined and broken up by shoreline end:
```{r}
GISveg_byshoreline <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month, -Year) %>% 
  filter(Zone == "All" & Shoreline_end != "both") %>% 
  mutate(Shoreline_end = factor(Shoreline_end, levels = c("west", "east"))) %>% 
  group_by(Shoreline_end)
  
```

#Hectares:
```{r}
GISvegplot <- ggplot(GISveg_byshoreline, 
                     mapping = aes(x = Date,
                                   y = Hectares,
                                   group = Shoreline_end,
                                   color = Shoreline_end)) +
  geom_point(size = 3) +
  guides(color = guide_legend(title = "Shoreline End")) +
  geom_line() +
  scale_color_manual(values = cbp) +
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=09),
        legend.text=element_text(size=09),
        legend.position = "top",   #for no legend type: "none"
        legend.background = element_rect(fill="lightgrey",
                                  size=0.5, linetype="solid", 
                                  colour ="darkgrey"),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GISvegplot
```


#Same thing as above but for percent cover:
```{r}
GISveg_byshoreline_percent <- GISvegdata_percent_v2 %>% 
  mutate(Date = paste0(Initial_year, "-", Month)) %>% 
  filter(Zone == "All") %>% 
  select(-Month, -Initial_year, -Total_area, -InitialVeg_area) %>% 
  mutate(Shore_end = factor(Shore_end, levels = c("west", "east"))) %>% 
         #Zone = (factor(Zone, levels = c("Upper", "Middle", "Lower")))) %>% 
  group_by(Shore_end, Date)
```


```{r}
GISvegplot_percent <- ggplot(GISveg_byshoreline_percent, 
                     mapping = aes(x = Date,
                                   y = InitialPercent_vegarea,
                                   group = Shore_end,
                                   color = Shore_end)) +
  geom_point(size = 3) +
  guides(color = guide_legend(title = "Shoreline End")) +
  geom_line() +
  scale_color_manual(values = cbp) +
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Veg Cover (%)",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_Plots_GIS.Rmd-GISvegplot_percent") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=09),
        legend.text=element_text(size=09),
        legend.position = "top",   #for no legend type: "none"
        legend.background = element_rect(fill="lightgrey",
                                  size=0.5, linetype="solid", 
                                  colour ="darkgrey"),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GISvegplot_percent
```


#Creating a data frame with all three zones combined and broken up by shoreline end:
```{r}
GISveg_byZandS <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month) %>% 
  filter(Zone == "All" & Shoreline_end != "both") %>% 
  mutate(Shoreline_end = factor(Shoreline_end, levels = c("west", "east")),
         Zone = factor(Zone, levels = c("Upper", "Middle", "Lower"))) %>% #make it so that facet grid orders shoreline end from west to east
  mutate(across(where(is.numeric), ~round(., 2))) %>% 
  group_by(Date, Zone, Shoreline_end) 
```

```{r}
GISvegplot_byYandS<- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Shoreline_end,
                                   y = Hectares,
                                   color = Shoreline_end,
                                   fill = Shoreline_end)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-0.04, 1.5)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Shoreline End",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_byYandS") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  #geom_text(aes(label = Hectares), #geom text is for the labels over the bars
   #             vjust = -0.8,  #higher values shift text down
    #            hjust = 0.5, #higher values shift text horizontally left
     #           position = position_stack(),
      #          color = "black",
       #         size = 3.25) +
  geom_label(aes(label = Hectares, y = -0.140),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))
  

GISvegplot_byYandS
```








#Creating a data frame with all three zones seperated and faceted by shoreline end and year:
```{r}
GISveg_byZYandS <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>%
  select(-Shapefile, -Month) %>% 
  filter(Zone != "All") %>% 
  mutate(across(where(is.numeric), ~round(., 2))) %>% 
  mutate(Shoreline_end = factor(Shoreline_end, levels = c("west","east")),
         Zone = factor(Zone, levels = c("Upper","Middle","Lower"))) #make it so that facet grid orders shoreline end from west to east
```

# *Hectares: Barplot faceted with Shoreline end and year, broken up by zone: 
```{r}
GISvegplot_byZYandS<- ggplot(GISveg_byZYandS, 
                     mapping = aes(x = Zone,
                                   y = Hectares,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-0.10, .80)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_byZYandS") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  #geom_text(aes(label = Hectares), #geom text is for the labels over the bars
   #             vjust = -0.8,  #higher values shift text down
    #            hjust = 0.5, #higher values shift text horizontally left
     #           position = position_stack(),
      #          color = "black",
       #         size = 3.25) +
  geom_label(aes(label = Hectares, y = -0.175),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))
  

GISvegplot_byZYandS
```

#Ok, Margot wants me to make the above plot but as a line/point plot, rather than a bar plot. Using the df from above..."
```{r}
GISvegplot_byZYandS_line <- ggplot(GISveg_byZYandS, 
                     mapping = aes(x = Date,
                                   y = Hectares,
                                   group = Shoreline_end,
                                   color = Shoreline_end)) +
  geom_point(position = position_dodge(0.5), size = 3) +
  guides(color = guide_legend(title = "Shoreline End")) +
  geom_line(position = position_dodge(0.5)) +
  facet_grid(~ Zone) +
  scale_color_manual(values = cbp) +
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years By Zone via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_byZYandS_line") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=09),
        legend.text=element_text(size=09),
        legend.position = "top",   #for no legend type: "none"
        legend.background = element_rect(fill="lightgrey",
                                  size=0.5, linetype="solid", 
                                  colour ="darkgrey"),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GISvegplot_byZYandS_line
```








#Total Veg change final - initial:
```{r}
TotalVeg_change_GIS <- GISveg_byZYandS %>% 
  #filter(Date == "2022-Aug" | Date == "2023-Aug") %>% #use for only comparing change between two years
  arrange(Date) %>% #arrange by date so the calculations can be made below
  group_by(Shoreline_end, Zone) %>% 
  summarize(initial_count = first(Hectares),
         final_count = last(Hectares),
         Hectares = (final_count - initial_count)) %>%
  ungroup() #%>% 
  #filter(!(Date == "2021-Dec")) #%>%  #this just removes the June count_difference data bc it is a repeat for the august data and we only need one calculation
  #group_by(Date, Zone, Shoreline_end, Log_Presence) %>% 
  #summarize(mean_cover = mean(count_difference, na.rm = TRUE),   #from here down you calculate summary statistics
  #          sd_cover = sd(count_difference, na.rm = TRUE),
  #          n_cover = n()) %>% 
  #mutate(se_cover = sd_cover/sqrt(n_cover)) %>% 
  #mutate(across(where(is.numeric), ~round(., 0))) %>% 
```

```{r}
GISvegplot_TotalVeg_change<- ggplot(TotalVeg_change_GIS, 
                     mapping = aes(x = Zone,
                                   y = Hectares,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(~ Shoreline_end) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-0.04, 0.50)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point Vegetation Cover Change Over 3 Years via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_TotalVeg_change") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        #legend.title = element_text(face = "bold", size=12),
        #legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_label(aes(label = Hectares, y = -0.07),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))
  

GISvegplot_TotalVeg_change
```





# ###  Percent Cover ### #

# Plot percent cover for all three dates, zones, and both shoreline ends:
```{r}
GIS_PercentCover <- GISvegdata_percent_v2 %>% 
  filter(Zone != "All") %>% 
  mutate(Date = paste0(Initial_year, "-", Month)) %>% 
  select(-Total_area, -year, -Month, -Initial_year, -InitialVeg_area) %>% 
  mutate(Shore_end = factor(Shore_end, levels = c("west","east")),
         Zone = factor(Zone, levels = c("Upper","Middle","Lower"))) #make it so that facet grid orders shoreline end from west to east
```

```{r}
GIS_PercentCover_line <- ggplot(GIS_PercentCover, 
                     mapping = aes(x = Date,
                                   y = InitialPercent_vegarea,
                                   group = Shore_end,
                                   color = Shore_end)) +
  geom_point(position = position_dodge(0.5), size = 3) +
  guides(color = guide_legend(title = "Shoreline End")) +
  geom_line(position = position_dodge(0.5)) +
  facet_grid(~ Zone) +
  scale_color_manual(values = cbp) +
  labs( 
    title = "Sears Point Vegetation Cover Over 3 Years By Zone via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Veg Cover (%)",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GIS_PercentCover_line") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=09),
        legend.text=element_text(size=09),
        legend.position = "top",   #for no legend type: "none"
        legend.background = element_rect(fill="lightgrey",
                                  size=0.5, linetype="solid", 
                                  colour ="darkgrey"),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GIS_PercentCover_line
```
#Same as above but with hectares:
```{r}
GISveg_byshoreline <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month, -Year, -ID) %>% 
  filter(Zone != "All" & Shoreline_end != "both") %>% 
  mutate(Shoreline_end = factor(Shoreline_end, levels = c("west", "east")),
         Zone = factor(Zone, levels = c("Upper", "Middle", "Lower"))) %>% 
  group_by(Shoreline_end, Zone, Date)
```

```{r}
GIS_Hectares_line <- ggplot(GISveg_byshoreline, 
                     mapping = aes(x = Date,
                                   y = Hectares,
                                   group = Shoreline_end,
                                   color = Shoreline_end)) +
  geom_point(position = position_dodge(0.5), size = 3) +
  guides(color = guide_legend(title = "Shoreline End")) +
  geom_line(position = position_dodge(0.5)) +
  facet_grid(~ Zone) +
  scale_color_manual(values = cbp) +
  labs( 
    title = "Sears Point Vegetation Cover Over 3 Years By Zone via GIS & Aerial Imagery",
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    x = "Date of Survey",
    y ="Hectares",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GIS_PercentCover_line") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=09),
        legend.text=element_text(size=09),
        legend.position = "top",   #for no legend type: "none"
        legend.background = element_rect(fill="lightgrey",
                                  size=0.5, linetype="solid", 
                                  colour ="darkgrey"),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 10),
        plot.subtitle = element_text(size = 10),
        strip.text = element_text(size = 13, color = "black")) 
  

GIS_Hectares_line
```




#Now to Plot Veg Percent Change for Dec 2021 to Aug 2023:
```{r}
GIS_PercChange_byZandS <- GISvegdata_percent %>% 
  filter(Zone !="All") %>% 
  filter(year == "3") %>% 
  mutate(Shore_end = factor(Shore_end, levels = c("west","east")),
         Zone = factor(Zone, levels = c("Upper","Middle","Lower"))) %>% #make it so that facet grid orders shoreline end from west to east
  select(Zone, Shore_end, Percent_change, Initial_year, Final_year, year) %>% 
  mutate(across(where(is.numeric), ~round(., 0))) 
  
```

```{r}
GIS_veg_PercentChange <- ggplot(GIS_PercChange_byZandS,
                               mapping = aes(x = Zone,
                                             y = Percent_change,
                                             group = Zone,
                                             fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  scale_fill_manual(values = cbp) +
  facet_grid(~ Shore_end) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-4, 60)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point % Veg Cover Change After 2 Year via GIS & Aerial Imagery",
    subtitle = "December 2021 to August 2023",
    x = "Marsh Zone",
    y ="Total Vegetation Cover (%)",
   #fill = "Log Presence",
   #caption = "*Error bars reflect standard error",
    tag = "Veg_plots_GIS.Rmd-GIS_veg_PercentChange") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        #legend.title = element_text(face = "bold", size=14),
        #legend.text=element_text(size=12),
        legend.position = "none",
        axis.text.x = element_text(size = 11),
        axis.text.y = element_text(size = 10),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_label(aes(label = Percent_change, y = -06.25),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))

GIS_veg_PercentChange
```

#Now to Plot Veg Percent Change for Dec 2021 to Aug 2022:
```{r}
GIS_PercChange_byZandS <- GISvegdata_percent %>% 
  filter(Zone !="All") %>% 
  filter(year == "1") %>% 
  mutate(Shore_end = factor(Shore_end, levels = c("west","east")),
         Zone = factor(Zone, levels = c("Upper","Middle","Lower"))) %>% #make it so that facet grid orders shoreline end from west to east
  select(Zone, Shore_end, Percent_change, Initial_year, Final_year) %>% 
  mutate(across(where(is.numeric), ~round(., 0))) 
  
```

```{r}
GIS_veg_PercentChange_yr1<- ggplot(GIS_PercChange_byZandS,
                               mapping = aes(x = Zone,
                                             y = Percent_change,
                                             group = Zone,
                                             fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  scale_fill_manual(values = cbp) +
  facet_grid(~ Shore_end) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-3, 60)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point % Veg Cover Change After 1 Year via GIS & Aerial Imagery",
    subtitle = "December 2021 to August 2022",
    x = "Marsh Zone",
    y ="Total Vegetation Cover (%)",
   #fill = "Log Presence",
   #caption = "*Error bars reflect standard error",
    tag = "Veg_plots_GIS.Rmd-GIS_veg_PercentChange_yr1") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        #legend.title = element_text(face = "bold", size=14),
        #legend.text=element_text(size=12),
        legend.position = "none",
        axis.text.x = element_text(size = 11),
        axis.text.y = element_text(size = 10),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_label(aes(label = Percent_change, y = -6.5),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))

GIS_veg_PercentChange_yr1
```

#And Percent Change from Aug 2022 to Aug 2023
```{r}
GIS_PercChange_byZandS_yr2 <- GISvegdata_percent %>% 
  filter(Zone !="All") %>% 
  filter(year == "2") %>% 
  mutate(Shore_end = factor(Shore_end, levels = c("west","east")),
         Zone = factor(Zone, levels = c("Upper","Middle","Lower"))) %>% #make it so that facet grid orders shoreline end from west to east
  select(Zone, Shore_end, Percent_change, Initial_year, Final_year) %>% 
  mutate(across(where(is.numeric), ~round(., 0))) 

```

```{r}
GIS_veg_PercentChange_yr2<- ggplot(GIS_PercChange_byZandS_yr2,
                               mapping = aes(x = Zone,
                                             y = Percent_change,
                                             group = Zone,
                                             fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  scale_fill_manual(values = cbp) +
  facet_grid(~ Shore_end) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-15, 26)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point % Veg Cover Change After 1 Year via GIS & Aerial Imagery",
    subtitle = "August 2022 to August 2023",
    x = "Marsh Zone",
    y ="Total Vegetation Cover (%)",
   #fill = "Log Presence",
   #caption = "*Error bars reflect standard error",
    tag = "Veg_plots_GIS.Rmd-GIS_veg_PercentChange_yr2") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        #legend.title = element_text(face = "bold", size=14),
        #legend.text=element_text(size=12),
        legend.position = "none",
        axis.text.x = element_text(size = 11),
        axis.text.y = element_text(size = 10),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_label(aes(label = Percent_change, y = -17.5),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))

GIS_veg_PercentChange_yr2
  
```


#And Percent Change with both years on one plot:
```{r}
GIS_PercChange_byZandS_v3 <- GISvegdata_percent %>% 
  filter(Zone !="All") %>% 
  filter(year == "1" | year == "2") %>% 
  mutate(Shore_end = factor(Shore_end, levels = c("west","east")),
         Zone = factor(Zone, levels = c("Upper","Middle","Lower")),
         year = factor(year, levels = c("1", "2"))) %>% #make it so that facet grid orders shoreline end from west to east
  select(Zone, Shore_end, Percent_change, year, Initial_year, Final_year) %>% 
  mutate(across(where(is.numeric), ~round(., 0))) %>% 
  group_by(Shore_end, Zone, year)

```

```{r}
GIS_veg_PercentChange_v3<- ggplot(GIS_PercChange_byZandS_v3,
                               mapping = aes(x = Zone,
                                             y = Percent_change,
                                             group = year,
                                             fill = year)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  scale_fill_manual(values = cbp) +
  facet_grid(~ Shore_end) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(-15, 80)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = "Sears Point % Veg Cover Change Year 1 and Year 2 Comparison via GIS & Aerial Imagery",
    subtitle = "Year 1 = Dec 2021 to Aug 2022      Year 2 = Aug 2022 to Aug 2023",
    x = "Marsh Zone",
    y ="Total Vegetation Cover (%)",
   fill = "Year",
   #caption = "*Error bars reflect standard error",
    tag = "Veg_plots_GIS.Rmd-GIS_veg_PercentChange_v3") +
  theme_bw(base_size = 10) +
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=09),
        legend.text=element_text(size=09),
        legend.position = "top",   #for no legend type: "none"
        legend.background = element_rect(fill="lightgrey",
                                  linewidth =0.5, linetype="solid", 
                                  colour ="darkgrey"),
        axis.text.x = element_text(size = 11),
        axis.text.y = element_text(size = 10),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_label(aes(label = Percent_change, y = -21.25),  # Adjust the x-coordinate
           vjust = -0.5,
           color = "black",
           position = position_dodge(0.85),
           size = 3.25,
           fill = "lightgrey",
           label.padding = unit(0.15, "lines"),
           label.r = unit(0.15, "lines"))
           


GIS_veg_PercentChange_v3
  
```
#Same thing as above but only for SpFo:
```{r}
GISvegplot_SpFO <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = Spartina_SM,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 6000)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point  " *italic("Spartina foliosa")* "  Cover Change Over 3 Years via GIS & Aerial Imagery"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Square Meters",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_SpFO") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = Spartina_SM), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  
GISvegplot_SpFO
```





#Same thing as above but for SpFo % Cover:
```{r}
GISvegplot_SpFO_perc <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = Spartina_PercCov,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 75)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point " *italic("Spartina foliosa")* " Percent Cover Change Over 3 Years via GIS & Aerial Imagery"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Vegetation Cover (%)",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_SpFO_perc") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = paste0(round(Spartina_PercCov), "%")), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  
GISvegplot_SpFO_perc
```




#Same thing as above but only for SaPa:
```{r}
GISvegplot_Pickle <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = Pickleweed_SM,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 3100)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point Pickleweed Zone Cover Change Over 3 Years via GIS & Aerial Imagery"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Square Meters",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_Pickle") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = Pickleweed_SM), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  
GISvegplot_Pickle
```



#Same thing as above but for SaPa % Cover:
```{r}
GISvegplot_Pickle_perc <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = Pickleweed_PercCov,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 120)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point Pickleweed Zone Percent Cover Change Over 3 Years via GIS & Aerial Imagery"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Vegetation Cover (%)",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_Pickle_perc") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = paste0(round(Pickleweed_PercCov), "%")), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  
GISvegplot_Pickle_perc
```



#Same thing as above but only for Mixed Veg:
```{r}
GISvegplot_Mixed <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = MixedVeg_SM,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 3100)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point Transition Zone Cover Change Over 3 Years via GIS & Aerial Imagery"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Square Meters",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_Mixed") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = MixedVeg_SM), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  
GISvegplot_Mixed
```



#Same thing as above but for Mixed Veg % Cover:
```{r}
GISvegplot_Mixed_perc <- ggplot(GISveg_byZandS, 
                     mapping = aes(x = Zone,
                                   y = MixedVeg_PercCov,
                                   color = Zone,
                                   fill = Zone)) +
  geom_col(position = position_dodge(0.85),color = "black", width = 0.85) +
  scale_fill_manual(values = cbp) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 120)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point Pickleweed Zone Percent Cover Change Over 3 Years via GIS & Aerial Imagery"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Vegetation Cover (%)",
    #caption = "*Error bars reflect standard error",
    fill = "Shoreline End",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_Mixed_perc") +
  theme_bw(base_size = 10) +
  guides(fill = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) +
  geom_text(aes(label = paste0(round(MixedVeg_PercCov), "%")), #geom text is for the labels over the bars
                vjust = -0.8,  #higher values shift text down
                hjust = 0.5, #higher values shift text horizontally left
                position = position_stack(),
                color = "black",
                size = 3.25)
  
GISvegplot_Mixed_perc
```





#Now to place all three veg communites on top of each other in one bar chart:
```{r}
GISveg_Combined <- GISvegdata %>% 
  mutate(Date = paste0(Year, "-", Month)) %>% 
  select(-Shapefile, -Month) %>% 
  filter(Zone != "All", Shoreline_end != "both") %>% 
  #pivot_longer(cols = c(MixedVeg_SM, Pickleweed_SM, Spartina_SM),
  #             names_to = "VegComm_SM",
  #             values_to = "square_meters") %>%
  pivot_longer(cols = c(MixedVeg_PercCov, Pickleweed_PercCov, Spartina_PercCov),
               names_to = "PercentCover",
               values_to = "Percent") %>% 
  mutate(Shoreline_end = factor(Shoreline_end, levels = c("west", "east")),
         Zone = factor(Zone, levels = c("Upper", "Middle", "Lower"))) %>% #make it sot hat facet grid orders shoreline end from west to east
  group_by(Date, Zone, Shoreline_end) 
```

```{r}
GISvegplot_Combined <- ggplot(GISveg_Combined, 
                     mapping = aes(x = Zone,
                                   y = Percent,
                                   color = PercentCover,
                                   fill = PercentCover)) +
  geom_col(position = "stack") +
  scale_fill_manual(values = cbp,
                    name="Vegetation\nCommunity",
                    labels=c("Mixed Transitional", "Pickleweed", "Spartina")) +
  geom_hline(yintercept=0, linetype="dashed", color = "black") +
  facet_grid(Shoreline_end ~ Year) +
  scale_x_discrete(labels = c(U = "Upper", M = "Middle", L = "Lower")) +
  coord_cartesian(ylim = c(0, 120)) + #sets the limit of the y-axis to show a more dramatic difference bw variables
  labs( 
    title = expression(paste(bold("Sears Point Veg Community Cover Change Over 3 Years via GIS & Aerial Imagery (%)"))),
    subtitle = "Based on UAV imagery taken in Dec 2021, Aug 2022, and Aug 2023",
    caption = "*This plot depicts vegetation solely within Becca Morris's Thesis Project Extent 
    and does not encompass the entire Sears Point Adaptive Management Project Restoration",
    x = "Marsh Zone",
    y ="Percent Cover (%)",
    #caption = "*Error bars reflect standard error",
    fill = "Veg Community",
    tag = "Veg_plots_GIS.Rmd-GISvegplot_Combined") +
  theme_bw(base_size = 10) +
  guides(color = FALSE) + #turns off legend for fill
  theme(axis.title = element_text(face = "bold", size=12),
        legend.title = element_text(face = "bold", size=12),
        legend.text=element_text(size=10),
        axis.text.x = element_text(size = 09),
        axis.text.y = element_text(size = 09),
        plot.title = element_text(face = "bold", size = 11),
        plot.caption = element_text(size = 07),
        plot.subtitle = element_text(size = 10),
        plot.tag = element_text(size = 6, angle = 90),
        plot.tag.position = "right",
        strip.text = element_text(size = 13, color = "black")) # +
  #geom_text(aes(label = Percent), #geom text is for the labels over the bars
  #              vjust = -0.8,  #higher values shift text down
  #              hjust = 0.5, #higher values shift text horizontally left
  #              position = position_stack(),
  #              color = "black",
  #              size = 3.25)
  
GISvegplot_Combined
```